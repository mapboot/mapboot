(()=>{var Zt=Object.defineProperty;var D=(e,t)=>()=>(e&&(t=e(e=0)),t);var en=(e,t)=>{for(var o in t)Zt(e,o,{get:t[o],enumerable:!0})};var pt,ut,yt,ft,mt,ye,ue,He,Be,gt,Nn,$e,Ee=D(()=>{pt="#EAEAEA",ut="#DDE1E2",yt="#C9CED2",ft="#C1C3C7",mt="#586974",ye=Object.freeze({REGULAR:"regular",TRANSIT:"transit"}),ue=Object.freeze({FLOOR:"floor",PUBLIC:"public",PRIVATE:"private",INNERWALL:"innerwall",OUTERWALL:"outerwall",NONE:"none"}),He=[ue.FLOOR,ue.PUBLIC,ue.PRIVATE,ue.INNERWALL,ue.OUTERWALL,ue.NONE],Be=class{constructor(t,o,n){this.id=t,this.color=o,this.lineThickness=n,this.enabled=!0}},gt=Object.freeze({Custom:"Custom",Exit:"Exit",Information:"Information",Restroom:"Restroom",FamilyRestroom:"Family Restroom",MaleRestroom:"Male Restroom",FemaleRestroom:"Female Restroom",Parking:"Parking",AccessibleRamp:"Accessible Ramp",ATM:"ATM",FirstAid:"FirstAid",Security:"Security",FireExtinguisher:"Fire Extinguisher",EmergencyExit:"Emergency Exit",LostAndFound:"Lost And Found",WaitingArea:"Waiting Area",ChargingStation:"Charging Station",VendingMachine:"Vending Machine",FoodService:"Food Service",Cafeteria:"Cafeteria",WaterFountain:"Water Fountain",SmokingArea:"Smoking Area",Playground:"Playground",GreenSpace:"Green Space",Kiosk:"Kiosk",Current_Kiosk:"Current Kiosk",FoodService:"Food Service",Taxi:"Taxi",Bus:"Bus",RideShare:"RideShare",Stairs:"Stairs",Escalator:"Escalator",Elevator:"Elevator",ServiceElevator:"Service Elevator",CrateElevator:"CrateE levator",FreightElevator:"Freigh tElevator",TrashCompactor:"Trash Compactor",TrashOpenBox:"Trash Open Box"}),Nn=Object.freeze({Meters:"m",Feet:"feet"}),$e=Object.freeze({None:"None",Icon:"Icon",Label:"Label"})});var Xe,Ue,Pe,be,Ye,we=D(()=>{Ee();Xe=class{constructor(t={}){this.name=t.name,this.locations=[...t.locations],this.lines=[...t.lines],this.polygons={},t.polygons&&typeof t.polygons=="object"&&Object.entries(t.polygons).forEach(([o,n])=>{this.polygons[o]=new Ye(n)})}},Ue=class{constructor(t={}){this.name=t.name,this.type=t.type,this.meta=t.meta,this.center=t.center,this.layers={},t&&typeof t.layers=="object"&&!Array.isArray(t.layers)&&(this.layers=Object.entries(t.layers).reduce((o,[n,i])=>{let s=new Xe(i);return o[n]=s,o},{}))}},Pe=class{constructor(t={}){this.id=t.id,this.name=t.name,this.meta=t.meta,this.owner=t.owner||"Mapboot.com",this.groups={},t&&typeof t.groups=="object"&&!Array.isArray(t.groups)&&(this.groups=Object.entries(t.groups).reduce((n,[i,s])=>{let r=new Ue(s);return n[i]=r,n},{})),this.styles={},[["none",null,0],["floor",pt,0],["public",ut,0],["private",yt,0],["innerwall",ft,2],["outerwall",mt,3]].forEach(([n,i,s])=>{let r=new Be(n,i,s);this.styles[n]=r}),Object.assign(this,t);for(let n of Object.values(this.groups))for(let i of Object.values(n.layers)){i.polygonsByStyle={};for(let[s,r]of Object.entries(i.polygons||{})){let a=r.styleId||"floor";(i.polygonsByStyle[a]??=[]).push(s)}i.linesByStyle={};for(let[s,r]of Object.entries(i.lines||{})){if(!r)continue;let a=r.styleId||"none";(i.linesByStyle[a]??=[]).push(s)}}}},be=class{constructor(t={}){t&&(this.id=t.id,this.name=t.name,this.meta=t.meta,this.groupId=t.groupId,this.layerId=t.layerId,this.locationType=t.locationType,this.displayType=t.displayType,this.center=t.center,this.iconUrl=t.iconUrl,this.polygonIds=[...t.polygonIds])}},Ye=class{constructor(t){this.points=[...t.points],this.styleId=t.styleId}}});async function Ve(e,t={}){let o=await fetch(e,{mode:"cors",headers:t});if(!o.ok)throw new Error(`${o.status}\xA0${o.statusText} \u2013 ${e}`);return o.json()}async function ht({mapid:e,onSuccess:t,onError:o}){try{let[n]=await Promise.all([Ve(tn,{mapid:e})]);t?.(n)}catch(n){o?.(n)}}async function xt({mapid:e,query:t,onSuccess:o,onError:n}){try{let[i]=await Promise.all([Ve(sn,{mapid:e,query:t})]);o?.(i)}catch(i){n?.(i)}}async function Ge({mapid:e,locationid:t}){console.log("Fetching location via headers \u2192",{mapid:e,locationid:t});let o=await fetch(nn,{method:"GET",headers:{mapid:e,locationid:t,"Content-Type":"application/json"}});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);let n=await o.json();return new be(n)}async function vt({mapid:e,fromlocationid:t,tolocationid:o,wchr:n,onSuccess:i,onError:s}){if(!(!e||!t||!o))try{let[r]=await Promise.all([await Ve(on,{mapid:e,fromlocationid:t,tolocationid:o,wchr:n,unit:"m"})]);i?.(r)}catch(r){console.error("PathFinding fetch error:",r),s?.(r),deadOverlay?.classList.remove("hidden")}finally{loadingOverlay?.classList.add("hidden")}}var tn,nn,on,sn,Le=D(()=>{we();tn="https://mapbootpublicfunc-cxgzgbe9gkajfggy.eastus2-01.azurewebsites.net/api/get_map?code=YEXmtXrt9sUhtY3d-tXDB5GzBo0E53Vy92fHdQ_3-BteAzFuZOoOkQ==",nn="https://mapbootpublicfunc-cxgzgbe9gkajfggy.eastus2-01.azurewebsites.net/api/get_location?code=YEXmtXrt9sUhtY3d-tXDB5GzBo0E53Vy92fHdQ_3-BteAzFuZOoOkQ==",on="https://mapbootpublicfunc-cxgzgbe9gkajfggy.eastus2-01.azurewebsites.net/api/get_pathfinding?code=YEXmtXrt9sUhtY3d-tXDB5GzBo0E53Vy92fHdQ_3-BteAzFuZOoOkQ==",sn="https://mapbootpublicfunc-cxgzgbe9gkajfggy.eastus2-01.azurewebsites.net/api/search_location?code=YEXmtXrt9sUhtY3d-tXDB5GzBo0E53Vy92fHdQ_3-BteAzFuZOoOkQ=="});function qe(e,t={}){let{onUpdate:o=()=>{},initialPan:n={dx:0,dy:0},initialScale:i=10}=t;if(!e)throw new Error("Canvas element is required");let s={scale:i,dx:n.dx??0,dy:n.dy??0,rotation:0},r=K.IDLE,a={x:0,y:0},u={[K.IDLE]:{[X.POINTER_DOWN]:p=>p.altKey||p.metaKey?(a.x=c(p),a.y=d(p),K.PANNING):K.IDLE,[X.POINTER_MOVE]:()=>K.IDLE,[X.POINTER_UP]:()=>K.IDLE,[X.WHEEL]:p=>(p.metaKey||p.ctrlKey?v(p):m(p),r)},[K.PANNING]:{[X.POINTER_MOVE]:p=>(I(p),K.PANNING),[X.POINTER_UP]:()=>K.IDLE,[X.WHEEL]:p=>(p.metaKey||p.ctrlKey?v(p):m(p),r)}};function c(p){return p.touches&&p.touches.length>0?p.touches[0].clientX:p.clientX}function d(p){return p.touches&&p.touches.length>0?p.touches[0].clientY:p.clientY}function y(p,z){let k=e.getBoundingClientRect(),A=e.width/k.width,N=e.height/k.height,$=(p-k.left)*A,Y=(z-k.top)*N;return{x:$,y:Y}}function I(p){let z=c(p),k=d(p),A=y(z,k),N=y(a.x,a.y),$=A.x-N.x,Y=A.y-N.y;s.dx+=$,s.dy+=Y,a.x=z,a.y=k,o({...s})}function m(p){p.preventDefault();let k=(p.deltaMode||0)===1?15:1,A=Math.exp(-p.deltaY*.001*k),N=y(p.clientX,p.clientY),$=s.scale*A,Y=N.x-(N.x-s.dx)*A,de=N.y-(N.y-s.dy)*A;s.scale=$,s.dx=Y,s.dy=de,o({...s})}function v(p){p.preventDefault();let k=(p.deltaMode||0)===1?15:1,A=-p.deltaY*.002*k,{scale:N,rotation:$,dx:Y,dy:de}=s,ee=y(p.clientX,p.clientY),pe=Math.cos(-$),Ie=Math.sin(-$),B=((ee.x-Y)*pe-(ee.y-de)*Ie)/N,_=((ee.x-Y)*Ie+(ee.y-de)*pe)/N,M=$+A,ct=Math.cos(M),dt=Math.sin(M),Jt=ee.x-N*(ct*B-dt*_),Qt=ee.y-N*(dt*B+ct*_);s.rotation=M,s.dx=Jt,s.dy=Qt,o({...s})}function E(p,z){let k=u[r]?.[p];if(k){let A=k(z);A&&A!==r&&(r=A)}}function O(p){E(X.POINTER_DOWN,p)}function h(p){E(X.POINTER_MOVE,p)}function C(p){E(X.POINTER_UP,p)}function F(p){E(X.WHEEL,p)}return e.addEventListener("mousedown",O),e.addEventListener("mousemove",h),e.addEventListener("mouseup",C),e.addEventListener("mouseleave",C),e.addEventListener("wheel",F,{passive:!1}),e.addEventListener("touchstart",O,{passive:!1}),e.addEventListener("touchmove",h,{passive:!1}),e.addEventListener("touchend",C,{passive:!1}),{getTransform(){return{...s}},setTransform(p){s={...p},o({...s})},reset(){s={scale:1,dx:0,dy:0,rotation:0},o({...s})},getState(){return r},destroy(){e.removeEventListener("mousedown",O),e.removeEventListener("mousemove",h),e.removeEventListener("mouseup",C),e.removeEventListener("mouseleave",C),e.removeEventListener("wheel",F),e.removeEventListener("touchstart",O),e.removeEventListener("touchmove",h),e.removeEventListener("touchend",C)}}}var K,X,It=D(()=>{K={IDLE:"IDLE",PANNING:"PANNING"},X={POINTER_DOWN:"POINTER_DOWN",POINTER_MOVE:"POINTER_MOVE",POINTER_UP:"POINTER_UP",WHEEL:"WHEEL"};typeof window<"u"&&(window.createNavigator=qe)});function Ce(e){if(!e)return;L=e;let t=document.getElementById("layersPanel");t&&(t.style.display="none"),console.log("new path finding reslut:",L)}function Ke(e){L=null,e?g=null:x=null;let t=document.getElementById("layersPanel");t&&(t.style.display="block"),console.log("clean path finding")}function J(e){e&&(b=e,console.log("GroupId set to:",e))}function Te(e){e&&(g=e)}function Se(e){e&&(x=e)}function ke(e){V=e}function Et(e){(e!=="m"||e!=="ft")&&(e="m"),G=e}function H(e,t=!0){if(e){if(w=e,t){let o=f.groups[b];if(!o||!o.layers[w])return;bt(b,w);let i={newLayerId:e};window.dispatchEvent(new CustomEvent("indoorlens_viewer:floorChangeDelegate",{detail:i})),R()}console.log("LayerId set to:",e)}}var L,w,g,x,b,V,G,te=D(()=>{Q();ne();we();L={},w=null,g=null,x=null,b=null,V=!1,G="m"});function wt(){let e=document.getElementById("directions"),t=document.getElementById("directionsBanner");if(Object.keys(L).length&&oe.length===0){for(let[n,i]of Object.entries(L))for(let[s,r]of Object.entries(i))oe.push({groupId:n,layerId:s,direction:r.direction});let o=oe.findIndex(n=>n.groupId===g.groupId&&n.layerId===g.layerId);Z=o!==-1?o:0}Je()}function Je(){if(oe.length===0||Z<0||Z>=oe.length)return;let e=oe[Z];J(e.groupId),H(e.layerId),window.dispatchEvent(new Event("IndoorLens:floorChangeDelegate")),rn()}function Lt(){oe.length=0,Z=0}function rn(){if(!L||!Object.keys(L).length)return;let e=L[b];if(!e)return;let t=e[w];if(!t)return;let o=t.segment,n=[];o.forEach(a=>{n.push({x:a.x,y:a.y})});let i=f.groups[b];if(!i)return;let s=i.layers[w];if(!i)return;let r=s.polygonsByStyle?.floor;r&&(r.forEach(a=>{s.polygons[a].points.forEach((c,d)=>{n.push({x:c.x,y:c.y})})}),n.length&&fe(n,{padding:250}))}var oe,Z,Ct=D(()=>{te();Q();ne();oe=[],Z=0;window.addEventListener("IndoorLens:directionPrev",()=>{Z>0&&(Z--,Je())});window.addEventListener("IndoorLens:directionNext",()=>{Z<oe.length-1&&(Z++,Je())})});function me(e,t,o,n,i){Lt(),ge();let s=requestAnimationFrame(Oe);Tt(s);let r=document.getElementById("loadingOverlay"),a=document.getElementById("deadOverlay");r?.classList.remove("hidden"),a?.classList.add("hidden"),vt({mapid:e,fromlocationid:t,tolocationid:o,wchr:n,unit:i,onSuccess:u=>{Ce(u),console.log("path finding data success:"+JSON.stringify(u)),r?.classList.add("hidden"),a?.classList.add("hidden")},onError:u=>{console.error(u),console.error("could not get path finding data from cloud, error:",u),r?.classList.add("hidden"),a?.classList.remove("hidden")}}).finally(()=>{wt(),R()})}var Ae=D(()=>{Q();te();Ct();Le()});function Rt(){let e=document.getElementById("from"),t=document.getElementById("to"),o=document.getElementById("fromResultsList"),n=document.getElementById("toResultsList"),i=document.getElementById("btnFromClear"),s=document.getElementById("btnToClear");e.addEventListener("input",()=>{i.disabled=e.value.trim()==="",console.log("search field  changed from")}),i.addEventListener("click",()=>{e.value="",o.innerHTML="",i.disabled=!0,e.focus(),document.getElementById("directionsBanner").classList.add("hidden"),Se(null),Ke(!0),Ce({}),ge(),R()}),t.addEventListener("input",()=>{s.disabled=t.value.trim()==="",console.log("search field  changed to")}),s.addEventListener("click",()=>{t.value="",n.innerHTML="",s.disabled=!0,e.focus(),document.getElementById("directionsBanner").classList.add("hidden"),Te(null),Ke(!1),Ce({}),ge(),R()}),Ot(e,o),Ot(t,n),e.addEventListener("blur",()=>{setTimeout(()=>{o.innerHTML=""},200)}),t.addEventListener("blur",()=>{setTimeout(()=>{n.innerHTML=""},200)}),e.addEventListener("focus",()=>{let r=e.value.trim().toLowerCase();r&&Qe(r,o)}),t.addEventListener("focus",()=>{let r=t.value.trim().toLowerCase();r&&Qe(r,n)})}function Qe(e,t){clearTimeout(St),St=setTimeout(()=>{an(e,t)},300)}function an(e,t){let o=f.id;xt({mapid:o,query:e,onSuccess:n=>{let i=[...n];t.innerHTML=i.map(s=>{if(g&&g.id==s.id||x&&x.id==s.id)return;let r=he(s);return`<li
            class="list-group-item list-group-item-action p-1"
            data-rawLocation='${JSON.stringify(s)}'>
            ${r}
          </li>`}).join("")},onError:n=>{console.error(n)}}).finally(()=>{R()})}function ln(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function cn(e){return e&&e.charAt(0).toUpperCase()+e.slice(1)}function he(e){let t=e.groupId,o=e.layerId,n=e.name?e.name:e.locationType,i=f.groups[t];if(!i)return;let s=i.name,r=i.layers[o];if(!r)return;let a=r.name,u=[n,s,a].map(ln).map(cn),[c,d,y]=u;return[`${c} at ${d}, ${y}`,`${c}, ${y} of ${d}`,`${c} on the ${y} in ${d}`,`${y}, ${d} \u2014 ${c}`,`${c} (${y}, ${d})`][2]}function Ot(e,t){e.addEventListener("input",()=>{let o=e.value.trim().toLowerCase();if(!o){t.innerHTML="";return}Qe(o,t)}),t.addEventListener("click",o=>{let n=o.target.closest("li");if(!n)return;let i=n.getAttribute("data-rawlocation"),s=n.textContent.trim();console.log("raw result clicked:"+i);let r=JSON.parse(i);if(e.value=s,t.innerHTML="",t.getAttribute("data-type")==="from"?Te(r):t.getAttribute("data-type")==="to"&&Se(r),g&&x)me(f.id,g.id,x.id,V,G);else if(J(r.groupId),H(r.layerId),r.polygonIds.length){let a=[];r.polygonIds.forEach(u=>{f.groups[r.groupId].layers[r.layerId].polygons[u].points.forEach(d=>{a.push({x:d.x,y:d.y})})}),a.length&&fe(a,{padding:300})}R()})}var St,Ze=D(()=>{Q();Ae();ne();te();Le()});function tt(){if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",tt,{once:!0});return}let e=document.getElementById("centerviewer"),t=document.getElementById("fullscreenviewer"),o=document.getElementById("accessibility"),n=document.getElementById("nextLayer"),i=document.getElementById("previousLayer"),s=document.getElementById("copyLink"),r=document.getElementById("canvasroot");if(!t||!r){console.warn("[IndoorLens] fullscreen toolbar init: required element(s) not found");return}e.addEventListener("click",()=>{Bt(10)}),o.addEventListener("click",()=>{ke(!V),Ne(),g&&x&&me(f.id,g.id,x.id,V,G)}),t.addEventListener("click",()=>{console.log("fullscreen btn clicked"),document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement?((document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen).call(document),et=!1):((r.requestFullscreen||r.webkitRequestFullscreen||r.msRequestFullscreen).call(r),et=!0),Ft()}),document.addEventListener("fullscreenchange",()=>{Re()});function a(c,d){let y=Object.keys(c.layers),I=y.indexOf(String(d));if(I===-1)return d;let m=Math.min(I+1,y.length-1);return n.style.opacity=m===y.length-1?.4:1,i.style.opacity=m===0?.4:1,y[m]}function u(c,d){let y=Object.keys(c.layers),I=y.indexOf(String(d));if(I===-1)return d;let m=Math.max(I-1,0);return n.style.opacity=m===y.length-1?.4:1,i.style.opacity=m===0?.4:1,y[m]}n.addEventListener("click",()=>{console.log("nextLayerBtn clicked");let c=f.groups[b];if(!c)return;let d=a(c,w);d!==w&&H(d)}),i.addEventListener("click",()=>{console.log("previousLayerBtn clicked");let c=f.groups[b];if(!c)return;let d=u(c,w);d!==w&&H(d)}),s.addEventListener("click",async()=>{let c=new URLSearchParams;c.set("mapid",f.id),c.set("type",window.mapboot.type),g&&c.set("from",g.id),x&&c.set("to",x.id);let d=`${window.location.origin}${window.location.pathname.split("?")[0]}?${c.toString()}`;try{await navigator.clipboard.writeText(d),alert("Link copied to clipboard!")}catch{if(window.prompt("Copy the link below:",d)===null)return}}),Ft(),Ne()}function Ft(){let t=document.getElementById("fullscreenviewer").querySelector("img");t&&(t.src=et?"https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Minimize.png":"https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Maximize.png")}function Ne(){let t=document.getElementById("accessibility").querySelector("img");t&&(t.src=V?"https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Wchr.png":"https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Walk.png",console.log("updateAccessibilityIcon ",V))}var et,nt=D(()=>{Q();te();ne();Ae();et=!1});function Pt(e){f=new Pe(e),ke(window.mapboot.wchr),Et(window.mapboot.unit),dn(),pn(),Ne();let t=document.getElementById("locationBadge");t.textContent=f.name;let o=document.getElementById("ownerBadge");o.textContent=f.owner,t.textContent=f.name,o.textContent=f.owner}async function dn(){let{mapid:e,fromid:t,toid:o}=window.mapboot;if(e){let n,i;if(t&&(n=await Ge({mapid:e,locationid:t})),o&&(i=await Ge({mapid:e,locationid:o})),n&&Te(n),i&&Se(i),g&&x){me(e,g.id,x.id,V,G),console.log("Automatic pathfinding requested:",e,g.id,x.id);let s=document.getElementById("from");s.value=he(g);let r=document.getElementById("btnFromClear");r.disabled=!1;let a=document.getElementById("to");a.value=he(x);let u=document.getElementById("btnToClear");u.disabled=!1}else if(g){ot(g.id);let s=he(g),r=document.getElementById("from");r.value=s;let a=document.getElementById("btnFromClear");a.disabled=!1}else if(x){ot(x.id);let s=he(x),r=document.getElementById("to");r.value=s;let a=document.getElementById("btnToClear");a.disabled=!1}}}function pn(){let e=Object.keys(f.groups)[0];if(!e)return;J(e);let t=f.groups[e];if(!Object.keys(t.layers).length)return;let o=Object.keys(t.layers)[0];H(o)}var f,ne=D(()=>{we();Ae();Q();Le();Ze();nt();te()});function De(e,t=40){let o=document.createElement("div");o.style.width=`${t}px`,o.style.height="0px",o.style.borderTop="2px dashed #999",e.appendChild(o)}function Nt(e,t,o){let n=document.createElement("div");if(n.style.display="flex",n.style.alignItems="center",n.style.fontFamily="'Roboto', sans-serif",n.style.fontSize="11px",n.style.color="#000",t==="left"){let i=document.createElement("span");i.textContent=o,i.style.display="inline-block",i.style.width="80px",i.style.paddingRight="2px",i.style.textAlign="right",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.style.textOverflow="ellipsis",n.appendChild(i);let s=document.createElement("div");s.style.flexGrow="1",s.style.height="1px",s.style.background="#000",n.appendChild(s)}else{let i=document.createElement("div");i.style.flexGrow="1",i.style.height="1px",i.style.background="#000",n.appendChild(i);let s=document.createElement("span");s.textContent=o,s.style.display="inline-block",s.style.width="80px",s.style.paddingLeft="2px",s.style.textAlign="left",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",s.style.fontFamily="'Roboto', 'Segoe UI', 'Noto Sans', sans-serif",n.appendChild(s)}e.appendChild(n)}function Mt(){let e=P.parentElement;e.addEventListener("click",xn),e.addEventListener("pointermove",vn)}function ze(e,t,o,n,i){let s=document.createElement("div");s.className="il-direction-panel",s.style.background="#222831",s.style.border="1px solid #3A3F47",s.style.borderRadius="8px",s.style.boxShadow="0 2px 4px rgba(0,0,0,0.12)",s.style.padding="5px",s.style.margin="5px",s.style.minWidth="100px",s.style.minHeight="90px",s.style.opacity="0.8",s.style.fontFamily="'Roboto', sans-serif";let r=document.createElement("h4");if(r.textContent=t.name,r.style.fontSize="13px",r.style.fontWeight="600",r.style.color="#ffffff",r.style.fontFamily="'Roboto', sans-serif",r.style.textAlign="center",r.style.padding="0px 0px 5px 3px",r.style.margin="0px",s.appendChild(r),i){let u=document.createElement("div");u.textContent=i,u.style.fontSize="10px",u.style.color="#ccc",u.style.textAlign="center",u.style.marginBottom="4px",s.appendChild(u)}let a=document.createElement("ul");a.className="il-floor-list",a.style.listStyle="none",a.style.margin="0",a.style.padding="0",o.forEach(u=>{let c=document.createElement("li");c.style.display="flex",c.style.alignItems="center",c.style.fontSize="11px",c.style.fontFamily="'Roboto', sans-serif",c.style.marginBottom="4px";let d=document.createElement("span");d.style.display="inline-block",d.style.width="16px",d.style.height="16px",d.style.marginRight="6px",d.style.border="1px solid #444",d.style.borderRadius="3px",u===n?d.style.backgroundColor=yn:d.style.backgroundColor=un;let y=document.createElement("span");y.textContent=t.layers[u].name,y.style.opacity=u===n?"1":"0.75",y.style.color=u===n?"#ffffff":"#d3d3d3",c.appendChild(d),c.appendChild(y),a.appendChild(c)}),s.appendChild(a),e.appendChild(s)}function fn(e,t){let o=document.createElement("div");o.className="il-transition-strip",o.textContent=t,o.style.padding="4px 12px",o.style.background="#393E46",o.style.border="1px solid #4f545c",o.style.borderRadius="20px",o.style.fontSize="11px",o.style.fontWeight="500",o.style.color="#f0f0f0",o.style.fontFamily="'Roboto', sans-serif",e.appendChild(o)}function _e(e,t,o=!1){let n=document.createElement("div");n.className=`il-nav-btn il-nav-${t}`,n.textContent=t==="prev"?"\u276E":"\u276F",Object.assign(n.style,{width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",color:"#ffffff",background:"#222831",border:"1px solid #3A3F47",borderRadius:"50%",cursor:"pointer",userSelect:"none"}),o?(n.style.opacity="0.3",n.style.pointerEvents="none",n.style.cursor="default"):n.addEventListener("click",()=>{window.dispatchEvent(new CustomEvent(t==="prev"?"IndoorLens:directionPrev":"IndoorLens:directionNext"))}),e.appendChild(n)}function We(){let e=document.getElementById("il-direction-container")||P.parentElement.appendChild(Object.assign(document.createElement("div"),{id:"il-direction-container",className:"il-direction-wrap"}));e.innerHTML="",e.style.zIndex=10,Object.assign(e.style,{position:"absolute",top:"40px",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",pointerEvents:"auto"}),L&&Object.keys(L).length!==0?f.groups[b]?.type===ye.TRANSIT?hn(e):gn(e):mn(e)}function mn(e){if(!f||!b)return;let t=b,o=f.groups[t],n=Object.keys(o.layers),i;if(n.length<=3)i=n;else{let r=n.indexOf(String(w));r<=0?i=n.slice(0,3):r>=n.length-1?i=n.slice(-3):i=n.slice(r-1,r+2)}let s=w;ze(e,o,[...i].reverse(),s,"")}function gn(e){if(!f||!b)return;let t=L[b]?.[w]??{};console.log("pfLayer",JSON.stringify(t));let o=g?.id&&t.startLocation?.id===g.id,n=x?.id&&t.endLocation?.id===x.id,i=!o,s=!n;_e(e,"prev",!i);let r=t.startLocation?.name||"",a=t.startLocation?.id;if(r){let h=x&&x.id===a?kt:g&&g.id===a?At:"#000";Nt(e,"left",r),e.lastElementChild.style.color=h,De(e,40)}let u=b,c=f.groups[u],d=Object.keys(c.layers),y;if(d.length<=3)y=d;else{let h=d.indexOf(String(w));h<=0?y=d.slice(0,3):h>=d.length-1?y=d.slice(-3):y=d.slice(h-1,h+2)}let I=w,m=L[u]?.[w]?.distance??0,v=G==="ft"?`${Math.round(m*3.28084)} ft`:`${Math.round(m)} m`;ze(e,c,[...y].reverse(),I,v),De(e,40);let E=t.endLocation?.name||"",O=t.endLocation?.id;if(E){let h=x&&x.id===O?kt:g&&g.id===O?At:"#000";Nt(e,"right",E),e.lastElementChild.style.color=h}_e(e,"next",!s)}function hn(e){if(!f||!b)return;let t=L[b]?.[w]??{},o=g?.id&&t.startLocation.id===g.id,n=x?.id&&t.endLocation.id===x.id,i=!o,s=!n;_e(e,"prev",!i);let r=t.startLocation.groupId,a=t.endLocation.groupId,u=f.groups[r],c=Object.keys(u.layers),d;if(c.length<=3)d=c;else{let E=c.indexOf(String(w));E<=0?d=c.slice(0,3):E>=c.length-1?d=c.slice(-3):d=c.slice(E-1,E+2)}ze(e,u,[...d].reverse(),t.startLocation.layerId,"",f.groups[r]?.type===ye.TRANSIT),De(e,40);let y=L[b]?.[w]?.distance,I=y===void 0?null:G==="ft"?`${Math.round(y*3.28084)} ft`:`${Math.round(y)} m`;fn(e,I),De(e,40);let m=f.groups[a],v=Object.keys(m.layers);ze(e,m,v.slice(0,3).reverse(),t.endLocation.layerId,"",f.groups[a]?.type===ye.TRANSIT),_e(e,"next",!s)}function xn(e){if(!f||!L)return;let t=P.getBoundingClientRect(),o=e.clientX-t.left,n=e.clientY-t.top,i=o*(P.width/t.width),s=n*(P.height/t.height),r=Object.keys(f.groups[b].layers),a=5,m=120+(20+a+r.length*(16+a)+a)/2,v=60,E=250,O=P.width/2,h=O-E-v/2,C=O+E-v/2,F=m-v/2;i>=h&&i<=h+v&&s>=F&&s<=F+v&&window.dispatchEvent(new CustomEvent("IndoorLens:directionPrev")),i>=C&&i<=C+v&&s>=F&&s<=F+v&&window.dispatchEvent(new CustomEvent("IndoorLens:directionNext"))}function vn(e){if(!f||!L)return;let t=P.getBoundingClientRect(),o=e.clientX-t.left,n=e.clientY-t.top,i=o*(P.width/t.width),s=n*(P.height/t.height),r=Object.keys(f.groups[b].layers),a=5,m=120+(20+a+r.length*(16+a)+a)/2,v=60,E=250,O=P.width/2,h=O-E-v/2,C=O+E-v/2,F=m-v/2,p=Me,z=je;Me=i>=h&&i<=h+v&&s>=F&&s<=F+v,je=i>=C&&i<=C+v&&s>=F&&s<=F+v,P.style.cursor=Me||je?"pointer":"default",(Me!==p||je!==z)&&We()}var kt,un,At,yn,Me,je,st=D(()=>{ne();Q();te();Ee();we();kt="#911919ff",un="#e0e0e0ff",At="#25872fff",yn="rgba(255, 247, 0, 1)";Me=!1,je=!1});function jt(e){if(it.has(e))return it.get(e);let t=new Image;t.crossOrigin="anonymous",t.src=`https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/${e}`;let o={img:t,loaded:!1};return t.onload=()=>{o.loaded=!0,refreshViewport()},it.set(e,o),o}function Dt(e={}){let t=typeof e.locationType=="number"?gt[e.locationType]:e.locationType;return In[t]??""}var it,In,zt=D(()=>{Ee();it=new Map;In={Exit:"Exit.png",Entrance:"Entrance.png",Restroom:"Restroom.png",FamilyRestroom:"FamilyRestroom.png",MaleRestroom:"MaleRestroom.png",FemaleRestroom:"FemaleRestroom.png",FireExtinguisher:"FireExtinguisher.png",Kiosk:"Kiosk.png",Information:"Information.png",Current_Kiosk:"KioskCurrent.png",MedicalKit:"MedicalKit.png",Stairs:"Stairs.png",Escalators:"Escalators.png",Cafeteria:"Cafeteria.png",FoodService:"FoodService.png",Taxi:"Taxi.png",Bus:"Bus.png",RideShare:"RideShare.png",Elevator:"Elevator.png",ServiceElevator:"ServiceElevator.png",CrateElevator:"CrateElevator.png",FreightElevator:"FreightElevator.png",TrashCompactor:"TrashCompactor.png",TrashOpenBox:"TrashOpenBox.png"}});function Ut(e,t,o,n){ie=e,T=t,le=o,P=n,j=ie.getContext("2d"),l=T.getContext("2d"),U=le.getContext("2d"),_t=P.getContext("2d"),j.clearRect(0,0,ie.width,ie.height),l.clearRect(0,0,T.width,T.height),U.clearRect(0,0,le.width,le.height),_t.clearRect(0,0,P.width,P.height),T.addEventListener("dblclick",c=>{if(L)return;let d=T.getBoundingClientRect(),y=c.clientX-d.left,I=c.clientY-d.top,m=Math.floor(y*(T.width/d.width)),v=Math.floor(I*(T.height/d.height)),E=ie.getContext("2d").getImageData(m,v,1,1).data,O=`rgb(${E[0]},${E[1]},${E[2]})`,h=rt[O];h&&(h.groupId&&J(h.groupId),h.layerId&&H(h.layerId,!0),R())}),document.readyState==="complete"?Re():window.addEventListener("load",Re,{once:!0}),window.addEventListener("resize",Re),window.addEventListener("IndoorLens:floorChangeDelegate",c=>{ge(),re=requestAnimationFrame(Oe),R()});let i=window.devicePixelRatio||1,s=T.getBoundingClientRect(),r=s.width*i/2,a=s.height*i/2;ce=qe(T,{initialPan:{dx:r,dy:a},onUpdate:wn})}function wn(e){S=e.scale,q.x=e.dx,q.y=e.dy,W=e.rotation??0,Yt(),Vt(),We()}function R(){if(console.log("refreshViewport"),!ce)return;let e=ce.getTransform();e&&(S=e.scale,q.x=e.dx,q.y=e.dy,W=e.rotation??0,Yt(),Vt(),We())}function Yt(){l.setTransform(1,0,0,1,0,0),l.clearRect(0,0,T.width,T.height);let e=Math.cos(W),t=Math.sin(W);l.save(),l.setTransform(S*e,S*t,-S*t,S*e,q.x,q.y),Ln(),l.restore()}function Ln(){if(!f)return;Object.entries(f.groups).forEach(([o,n])=>{n.type!==ye.TRANSIT&&(Object.entries(n.layers).forEach(([i,s])=>{l.globalAlpha=.5;let r=s.polygonsByStyle?.floor;r&&(l.save(),r.forEach(a=>{let u=s.polygons[a];l.fillStyle=En,l.beginPath(),u.points.forEach((c,d)=>{d===0?l.moveTo(c.x,c.y):l.lineTo(c.x,c.y)}),l.closePath(),l.fill()}),l.restore())}),o!==b&&(l.globalAlpha=1,l.save(),l.translate(n.center.x,n.center.y),l.rotate(-W),l.scale(1/S,1/S),l.fillStyle="#000",l.font="16px Arial",l.textAlign="center",l.textBaseline="middle",l.fillText(n.name,0,0),l.restore()))}),l.globalAlpha=1;let e=f.groups[b];if(!e)return;let t=e.layers[w];t&&(l.globalAlpha=1,l.save(),Cn(t),Tn(t),Sn(),On(t),l.restore())}function Cn(e){He.forEach(t=>{let o=f.styles?.[t],n=e.polygonsByStyle?.[t];n&&n.forEach(i=>{let s=e.polygons[i];l.fillStyle=o.color,l.beginPath(),s.points.forEach((r,a)=>{a===0?l.moveTo(r.x,r.y):l.lineTo(r.x,r.y)}),l.closePath(),l.fill()})}),g&&g.polygonIds.forEach(t=>{let o=e.polygons[t];o&&(l.fillStyle="rgb(179, 231, 212)",l.beginPath(),o.points.forEach((n,i)=>i===0?l.moveTo(n.x,n.y):l.lineTo(n.x,n.y)),l.closePath(),l.fill())}),x&&x.polygonIds.forEach(t=>{let o=e.polygons[t];o&&(l.fillStyle="rgb(231, 179, 184)",l.beginPath(),o.points.forEach((n,i)=>i===0?l.moveTo(n.x,n.y):l.lineTo(n.x,n.y)),l.closePath(),l.fill())})}function Tn(e){He.forEach(t=>{let o=f.styles?.[t],n=e.linesByStyle?.[t];n&&n.forEach(i=>{let s=e.lines[i];if(!s)return;let r=s.points;r&&r.length>=2&&o&&(l.lineWidth=o.lineThickness/S,l.strokeStyle=o.color,l.beginPath(),l.moveTo(r[0].x,r[0].y),r.slice(1).forEach(a=>l.lineTo(a.x,a.y)),l.stroke())})})}function Sn(){if(!L||!Object.keys(L).length)return;let e=L[b];if(!e)return;let t=e[w];if(!t)return;let o=t.segment;if(!o)return;l.strokeStyle=bn;l.lineWidth=2/S,l.beginPath(),l.moveTo(o[0].x,o[0].y);for(let n=1;n<o.length;n++){let i=o[n];l.lineTo(i.x,i.y)}l.stroke()}function On(e){e.locations.forEach(t=>{if(t){if(t.displayType===$e.Icon){let o=Dt(t),n=jt(o);n.loaded&&(l.save(),l.translate(t.center.x,t.center.y),l.rotate(-W),l.scale(1/S,1/S),l.drawImage(n.img,-36/2,-36/2,36,36),l.restore())}if(t.displayType===$e.Label){let o=t.name??t.locationType;l.save(),l.translate(t.center.x,t.center.y),l.rotate(-W),l.scale(1/S,1/S),l.font="20px Arial",l.textAlign="center",l.textBaseline="middle",l.fillStyle="#000",l.fillText(o,0,0),l.restore()}}})}function Vt(){if(!f)return;j.setTransform(1,0,0,1,0,0),j.clearRect(0,0,ie.width,ie.height);let e=Math.cos(W),t=Math.sin(W);j.save(),j.setTransform(S*e,S*t,-S*t,S*e,q.x,q.y),Rn(),j.restore()}function Rn(){rt={},Wt=1,Object.entries(f.groups).forEach(([e,t])=>{let o=!0;Object.entries(t.layers).forEach(([n,i])=>{let s=i.polygonsByStyle?.floor;s&&(j.save(),s.forEach(r=>{let a=i.polygons[r],u=Wt++,c=u>>16&255,d=u>>8&255,y=u&255,I=`rgb(${c},${d},${y})`;rt[I]={groupId:e,layerId:n},j.beginPath(),a.points.forEach((m,v)=>{v===0?j.moveTo(m.x,m.y):j.lineTo(m.x,m.y)}),j.closePath(),j.fillStyle=I,j.fill()}),j.restore())})})}function Re(){let t=T.parentElement.getBoundingClientRect(),o=t.width*(window.devicePixelRatio||1),n=t.height*(window.devicePixelRatio||1);[ie,T,le,P].forEach(i=>{i.width=o,i.height=n,i.style.width=t.width+"px",i.style.height=t.height+"px"}),R()}function Ht(e,t,o){return e+(t-e)*o}function Bn(e,t,o){return{x:Ht(e.x,t.x,o),y:Ht(e.y,t.y,o)}}function ge(){re&&(cancelAnimationFrame(re),re=null),U.clearRect(0,0,T.width,T.height),ve=null,se=0,Fe=[],xe=[],ae=0}function Oe(e){if(at||!re||!L){re=requestAnimationFrame(Oe);return}let t=L[b];if(!t)return;let o=t[w];if(!o)return;let n=o.segment;if(!n||n.length<2)return;if(Fe.length!==n.length-1){Fe=[],xe=[0],ae=0;for(let h=0;h<n.length-1;h++){let C=n[h+1].x-n[h].x,F=n[h+1].y-n[h].y,p=Math.hypot(C,F);Fe.push(p),ae+=p,xe.push(ae)}}ve==null&&(ve=e);let i=(e-ve)/1e3;ve=e,se=Math.min(se+Fn*i,ae);let s=0;for(;s+1<xe.length&&xe[s+1]<se;)s++;let r=xe[s],a=Fe[s]||0,u=a>0?(se-r)/a:0,c=n[s],d=n[s+1],y=Bn(c,d,u);se>=ae&&(se=0,ve=e),U.save(),U.setTransform(1,0,0,1,0,0),U.clearRect(0,0,le.width,le.height);let I=Math.cos(W),m=Math.sin(W),v=S*(I*y.x-m*y.y)+q.x,E=S*(m*y.x+I*y.y)+q.y,O=6;U.beginPath(),U.arc(v,E,O,0,Math.PI*2),U.fillStyle="red",U.fill(),U.restore(),se<ae&&(re=requestAnimationFrame(Oe))}function Tt(e){re=e}function fe(e,{padding:t=250,duration:o=500,minScale:n=.5,maxScale:i=100}={}){if(!ce||!e?.length)return;let s=window.devicePixelRatio||1,r=T.width,a=T.height,u=1/0,c=1/0,d=-1/0,y=-1/0;e.forEach(B=>{let _=B.x,M=B.z??B.y;_==null||M==null||(_<u&&(u=_),M<c&&(c=M),_>d&&(d=_),M>y&&(y=M))});let I=(u+d)/2,m=(c+y)/2,v=Math.max(d-u,1e-6),E=Math.max(y-c,1e-6),O=r-t*s*2,h=a-t*s*2,C=Math.min(O/v,h/E);C=Math.max(n,Math.min(i,C));let F=Math.cos(W),p=Math.sin(W),z=r/2-C*(F*I-p*m),k=a/2-C*(p*I+F*m),{scale:A,dx:N,dy:$,rotation:Y}=ce.getTransform(),de=performance.now(),ee=B=>B<.5?2*B*B:-1+(4-2*B)*B,pe=(B,_,M)=>B+(_-B)*M;function Ie(B){at=!0;let _=Math.min((B-de)/o,1),M=ee(_);ce.setTransform({scale:pe(A,C,M),dx:pe(N,z,M),dy:pe($,k,M),rotation:Y}),_<1?requestAnimationFrame(Ie):at=!1}requestAnimationFrame(Ie)}function ot(e){if(J(location.groupId),H(location.layerId),location.polygonIds.length){let t=[];location.polygonIds.forEach(o=>{f.groups[location.groupId].layers[location.layerId].polygons[o].points.forEach(i=>{t.push({x:i.x,y:i.y})})}),t.length&&fe(t,{padding:300})}}function bt(e,t){let o=[],n=f.groups[e];if(!n)return;let i=n.layers[t];if(!i)return;l.save();let s=i.polygonsByStyle?.floor;s&&(s.forEach(r=>{i.polygons[r].points.forEach(u=>{o.push({x:u.x,y:u.y})})}),o.length&&fe(o,{padding:250}))}function Bt(e=6){console.log("reset centerView viewer");let t=T.width,o=T.height,n=0,i=0,s=t/2-e*n,r=o/2-e*i;ce.setTransform({scale:e,dx:s,dy:r,rotation:0}),R()}var $t,Xt,ie,T,le,P,re,ce,j,l,U,_t,S,q,W,rt,Wt,at,En,bn,se,Fe,xe,ae,Fn,ve,Q=D(()=>{Ee();It();ne();st();zt();te();$t=new Image;$t.src="/images/WalkLeft.png";Xt=new Image;Xt.src="/images/WalkRight.png";$t.onload=()=>R();Xt.onload=()=>R();ie=null,T=null,le=null,P=null,re=null,ce=null,j=null,l=null,U=null,_t=null,S=null,q={},W=0,rt={},Wt=0,at=!1,En="rgb(240, 240, 240)",bn="rgb(236, 35, 183)";se=0,Fe=[],xe=[],ae=0,Fn=7;ve=null});var qt={};en(qt,{buildIndoorLensDOM:()=>Gt,widget:()=>lt});async function Pn(){let e=await fetch("/dist/indoorlens-viewer.css").then(o=>o.text()),t=document.createElement("style");t.id="indoorlens\u2011css",t.textContent=e,document.head.appendChild(t)}function Gt(e){Pn();let t=document.createElement("div");t.id="canvasroot",t.style.position="relative",t.style.width="100%",t.style.height="100%",t.style.display="flex",t.style.flexDirection="row",t.style.alignItems="stretch",t.style.backgroundColor="white",e.appendChild(t);let o=document.createElement("div");o.className="ui-layout",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.zIndex="6",o.style.backgroundColor="transparent",o.style.pointerEvents="none",t.appendChild(o);let n=document.createElement("div");n.id="canvases-container",n.className="canvases-container",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.zIndex="0",t.appendChild(n);let i=document.createElement("canvas");i.id="canvasMain",i.className="canvas",i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.zIndex="1",n.appendChild(i);let s=document.createElement("canvas");s.id="canvasSelection",s.className="canvas",s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.zIndex="1000",s.style.opacity="0",s.style.pointerEvents="none",s.style.backgroundColor="transparent",n.appendChild(s);let r=document.createElement("canvas");r.id="canvasOverlay",r.className="canvas",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.height="100%",r.style.zIndex="2",r.style.pointerEvents="none",r.style.backgroundColor="transparent",n.appendChild(r);let a=document.createElement("canvas");a.id="canvasDirection",a.className="canvas ",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.zIndex="5",a.style.pointerEvents="none",n.appendChild(a),o.insertAdjacentHTML("beforeend",`
    <div  id="ownerBadge"  class="brand-badge">
      <span id="ownerBadge" >MapBoot.com</span>
    </div>

    <div class="location-badge"  >
      <span id="locationBadge"></span>
      <img src="https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/LocationPin.png" alt="Location Pin" />
    </div>
`),o.insertAdjacentHTML("beforeend",`
    <div id="searchBar" class="search-bar">
      <div class="flex-col">
        <div class="input-group">
          <span class="input-tag">From</span>
          <input id="from" type="text" class="input-field" placeholder="Search from\u2026" />
          <button id="btnFromClear" class="input-clear" disabled>&times;</button>
        </div>
        <ul id="fromResultsList"  data-type="from" class="results-list"></ul>
      </div>

      <div class="flex-col">
        <div class="input-group">
          <span class="input-tag">To</span>
          <input id="to" type="text" class="input-field" placeholder="Search to\u2026" />
          <button id="btnToClear" class="input-clear"  disabled>&times;</button>
        </div>
        <ul id="toResultsList" data-type="to" class="results-list"></ul>
      </div>
    <!-- Directions banner -->
    <div id="directionsBanner" class="directions-banner hidden">
      <button id="prevDir" class="dir-btn" aria-label="Previous">
      <img src="/images/WalkRight.png" alt="Walk" width="16" height="16">
      </button>

      <button id="nextDir" class="dir-btn" aria-label="Next">
      <img src="/images/WalkRight.png" alt="Walk" width="16" height="16">
      </button>
    </div>
  </div>  
    `);let u=o.querySelector(".search-bar");u.style.position="absolute",u.style.zIndex="9",u.style.pointerEvents="auto",o.insertAdjacentHTML("beforeend",`
   <div class="toolbar">
      <button id= "fullscreenviewer" class="panel-btn">
            <img src="https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Maximize.png" alt="fullscreen link" width="16" height="16">
      </button>
      <button id= "centerviewer" class="panel-btn">
            <img src="https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Center.png" alt="fullscreen link" width="16" height="16">
      </button>
    <button id= "accessibility" class="panel-btn">
            <img src="https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Wchr.png" alt="Walk" width="16" height="16">
      </button>
      <button id= "copyLink" class="panel-btn">
            <img src="/Images/Link.png" alt="API link" width="16" height="16">
      </button>
    </div>`),o.insertAdjacentHTML("beforeend",`
   <div id="layersPanel" class="toolbar">
            <button id="nextLayer" class="panel-btn">
                  <img src="/images/Up.png" alt="Walk" width="16" height="16">
            </button>
            <button id="previousLayer" class="panel-btn">
                  <img src="/images/Down.png" alt="Walk" width="16" height="16">
            </button>
    </div>`),o.querySelectorAll(".toolbar").forEach(y=>{y.style.position="absolute",y.style.zIndex="10",y.style.pointerEvents="auto"}),o.insertAdjacentHTML("beforeend",`
    <div id="loadingOverlay" class="loading-overlay hidden">
      <img src="https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Loader.png" class="spin" alt="loading"/>
    </div>
    <div id="deadOverlay" class="loading-overlay hidden">
      <img src="https://cdn.jsdelivr.net/gh/elseforty/IndoorLens/LocationIcons/Dead.png" alt="dead"/>
    </div>`);let c=o.querySelector("#loadingOverlay"),d=o.querySelector("#deadOverlay");if(window.mapboot.type==="viewer_limited"){let y=o.querySelector("#accessibility");y.style.display="none";let I=o.querySelector("#searchBar");I.style.display="none";let m=o.querySelector("#copyLink");m.style.display="none"}return{canvasSelection:s,canvasMain:i,canvasOverlay:r,canvasDirection:a,loadingOverlay:c,deadOverlay:d}}var lt,Kt=D(()=>{Le();Q();ne();nt();Ze();st();lt=class{constructor(t,o){this.root=t,this.opts=o;let n=Gt(this.root);Ut(n.canvasSelection,n.canvasMain,n.canvasOverlay,n.canvasDirection),Mt(),tt(),Rt();let i=this.opts.mapid,s=document.getElementById("loadingOverlay"),r=document.getElementById("deadOverlay");s?.classList.remove("hidden"),r?.classList.add("hidden"),ht({mapid:i,onSuccess:a=>{Pt(a),console.log("Successfully loaded map width id:",i),s?.classList.add("hidden"),r?.classList.add("hidden")},onError:a=>{console.error(a),console.error("Could not load map"),s?.classList.add("hidden"),r?.classList.remove("hidden")}}).finally(()=>{R()}),requestAnimationFrame(()=>R())}}});function kn(e={}){let t=new URLSearchParams(window.location.search),o=t.get("type")??e.type;o&&o==="viewer_limited"?o="viewer_limited":o="viewer";let n={target:e.target,mapid:t.get("mapid")??e.mapid,fromid:t.get("from")??e.fromid,toid:t.get("to")??e.toid,unit:e.unit,wchr:e.wchr,type:o};typeof window<"u"&&(window.mapboot=window.mapboot||{},window.mapboot.init=kn),window.mapboot.cfg={...n},Object.assign(window.mapboot,{mapid:n.mapid,fromid:n.fromid,toid:n.toid,type:n.type}),console.log("Initializing IndoorLens with:",`mapid=${n.mapid}, fromid=${n.fromid}, toid=${n.toid}`);let i=typeof n.target=="string"?document.querySelector(n.target):n.target;if(!i)throw new Error("IndoorLens: target element not found");Promise.resolve().then(()=>(Kt(),qt)).then(({widget:s})=>{window.mapboot=new s(i,n)})}})();
//!style? pathColor:
//# sourceMappingURL=mapboot.min.js.map
